// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º File System "fs" –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
const fs = require("—É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –¥–æ –º–æ–¥—É–ª—è");
// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞—Å—Å Assembler –∏–∑ —Ñ–∞–π–ª–∞ Assembler.js, —Ñ–∞–π–ª –ª–µ–∂–∏—Ç —Ä—è–¥–æ–º —Å —ç—Ç–∏–º —Ñ–∞–π–ª–æ–º
const Assembler = –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ_—Ñ–∞–π–ª_—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ;

// –ü–æ–ª—É—á–∞–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –±—ã–ª –∑–∞–ø—É—â–µ–Ω —Å–∫—Ä–∏–ø—Ç
const inputFile = process.argv[—É–∫–∞–∂–∏—Ç–µ_–Ω–æ–º–µ—Ä_–∞—Ä–≥—É–º–µ–Ω—Ç–∞];
const outputFile = process.argv[—É–∫–∞–∂–∏—Ç–µ_–Ω–æ–º–µ—Ä_–∞—Ä–≥—É–º–µ–Ω—Ç–∞];

// –í—ã–≤–æ–¥–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ –∫–æ–Ω—Å–æ–ª—å, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –Ω–∏—Ö –≤ –º–æ–º–µ–Ω—Ç –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞
console.log("args: ", { inputFile, outputFile });

// –ï—Å–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç inputFile –Ω–µ –±—ã–ª –ø–µ—Ä–µ–¥–∞–Ω –∏–ª–∏ —ç—Ç–æ –Ω–µ .asm —Ñ–∞–π–ª, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
if (–Ω–∞–ø–∏—à–∏—Ç–µ_—É—Å–ª–æ–≤–∏–µ_–¥–ª—è_—ç—Ç–æ–≥–æ_–≤—ã—Ä–∞–∂–µ–Ω–∏—è)
  throw new Error("Only .asm file can be assembled into .hack");

// –ï—Å–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç outputFile –Ω–µ –±—ã–ª –ø–µ—Ä–µ–¥–∞–Ω –∏–ª–∏ —ç—Ç–æ –Ω–µ .hack —Ñ–∞–π–ª, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
if (–Ω–∞–ø–∏—à–∏—Ç–µ_—É—Å–ª–æ–≤–∏–µ_–¥–ª—è_—ç—Ç–æ–≥–æ_–≤—ã—Ä–∞–∂–µ–Ω–∏—è)
  // –≤—ã–±—Ä–æ—Å–∏—Ç–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –æ—à–∏–±–∫—É –¥–ª—è outputFile'–∞

// –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ Assembler, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é assembler
const assembler = —Å–æ–∑–¥–∞–π—Ç–µ_—ç–∫–∑–µ–º–ø–ª—è—Ä_–∫–ª–∞—Å—Å–∞_Assembler;

// –ü–∏—à–µ–º –≤ –∫–æ–Ω—Å–æ–ª—å –æ –Ω–∞—á–∞–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞
console.log("Started assembling ‚è≥");

// –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª –ø–æ –∞–¥—Ä–µ—Å—É "/inputFile", —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é assembly
const assembly = fs.readFileSync(inputFile, "utf8");

// –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º –∫–æ–¥ –Ω–∞ —è–∑—ã–∫–µ –∞—Å—Å–µ–º–±–ª–µ—Ä–∞ –≤ –º–∞—à–∏–Ω–Ω—ã–π —è–∑—ã–∫, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –ø–µ—Ä–º–µ–Ω–Ω—É—é hack
const hack = assembler.assemble(assembly);

// –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª –ø–æ –∞–¥—Ä–µ—Å—É "/outputFile", –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –≤ —Ñ–∞–π–ª
fs.writeFileSync(outputFile, hack);

// –ü–∏—à–µ–º –≤ –∫–æ–Ω—Å–æ–ª—å –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞
console.log(`Finished assembling üåû`);

// –î–∞–ª–µ–µ –Ω–∞–ø–∏—à–∏—Ç–µ –∫–æ–¥ –¥–ª—è –∫–ª–∞—Å—Å–∞ Assembler, —Ñ–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ä—è–¥–æ–º —Å —ç—Ç–∏–º —Ñ–∞–π–ª–æ–º