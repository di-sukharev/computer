/*
    –ê–õ–£ (–ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–æ-–ª–æ–≥–∏—á–µ—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)

    –í—ã—á–∏—Å–ª—è–µ—Ç –æ–¥–Ω—É –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π:
    x+y, x-y, y-x, 0, 1, -1, x, y, -x, -y, !x, !y,
    x+1, y+1, x-1, y-1, x&y, x|y on two 16-bit inputs, 
    –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —à–µ—Å—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª –∏–Ω–ø—É—Ç–æ–≤: zx, nx, zy, ny, f, no.
    
    –í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ê–õ–£ –∏–º–µ–µ—Ç –¥–≤–∞ –∞—É—Ç–ø—É—Ç-—Ñ–ª–∞–≥–∞:
    –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∞—É—Ç–ø—É—Ç –ê–õ–£ == 0, —Ñ–ª–∞–≥ zr —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 1; –≤ –æ–±—Ä–∞—Ç–Ω–æ–º —Å–ª—É—á–∞–µ zr —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 0;
    –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π –∞—É—Ç–ø—É—Ç –ê–õ–£ < 0, —Ñ–ª–∞–≥ ng —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 1; –≤ –æ–±—Ä–∞—Ç–Ω–æ–º —Å–ª—É—á–∞–µ ng —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ 0.
*/

/* 
    –¢–∞–±–ª–∏—Ü–∞ —Ñ—É–Ω–∫—Ü–∏–π:
    | zx | nx | zy | ny | f | no | out |
    |----|----|----|----|---|----|-----|
    |  1 |  0 |  1 |  0 | 1 |  0 | 0   |
    |  1 |  1 |  1 |  1 | 1 |  1 | 1   |
    |  1 |  1 |  1 |  0 | 1 |  0 | -1  |
    |  0 |  0 |  1 |  1 | 0 |  0 | x   |
    |  1 |  1 |  0 |  0 | 0 |  0 | y   |
    |  0 |  0 |  1 |  1 | 0 |  1 | !x  |
    |  1 |  1 |  0 |  0 | 0 |  1 | !y  |
    |  0 |  0 |  1 |  1 | 1 |  1 | -x  |
    |  1 |  1 |  0 |  0 | 1 |  1 | -y  |
    |  0 |  1 |  1 |  1 | 1 |  1 | x+1 |
    |  1 |  1 |  0 |  1 | 1 |  1 | y+1 |
    |  0 |  0 |  1 |  1 | 1 |  0 | x-1 |
    |  1 |  1 |  0 |  0 | 1 |  0 | y-1 |
    |  0 |  0 |  0 |  0 | 1 |  0 | x+y |
    |  0 |  1 |  0 |  0 | 1 |  1 | x-y |
    |  0 |  0 |  0 |  1 | 1 |  1 | y-x |
    |  0 |  0 |  0 |  0 | 0 |  0 | x&y |
    |  0 |  1 |  0 |  1 | 0 |  1 | x|y |
*/

/*
    –ê–õ–£ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ 16-–±–∏—Ç–Ω—ã—Ö –∏–Ω–ø—É—Ç–∞
    –∏ —á—Ç–æ–±—ã –≤—ã—á–∏—Å–ª–∏—Ç—å –∞—É—Ç–ø—É—Ç, –º–∞–Ω–∏–ø—É–ª–∏—Ä—É–µ—Ç –∏–º–∏:
    –µ—Å–ª–∏ (zx == 1) —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å x=0 (16-–±–∏—Ç–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞)
    –µ—Å–ª–∏ (nx == 1) —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å x=!x (–ø–æ–±–∏—Ç–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è not)
    –µ—Å–ª–∏ (zy == 1) —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å y=0 (16-–±–∏—Ç–Ω–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞)
    –µ—Å–ª–∏ (ny == 1) —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å y=!y (–ø–æ–±–∏—Ç–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è not)
    –µ—Å–ª–∏ (f == 1)  —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å out=x+y (—Å–ª–æ–∂–µ–Ω–∏–µ –≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º –∫–æ–¥–µ)
    –µ—Å–ª–∏ (f == 0)  —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å out=x&y (–ø–æ–±–∏—Ç–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è and)
    –µ—Å–ª–∏ (no == 1) —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å out=!out (–ø–æ–±–∏—Ç–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è not)
    –µ—Å–ª–∏ (out == 0) —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å zr=1
    –µ—Å–ª–∏ (out < 0) —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ng=1
*/

CHIP ALU {
    IN
        x[16], y[16],  // 16-–±–∏—Ç–Ω—ã–µ –∏–Ω–ø—É—Ç—ã: x, y;
        zx, // —Ñ–ª–∞–≥: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–Ω–ø—É—Ç x=0
        nx, // —Ñ–ª–∞–≥: –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–ø—É—Ç x
        zy, // —Ñ–ª–∞–≥: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–Ω–ø—É—Ç y=0
        ny, // —Ñ–ª–∞–≥: –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–ø—É—Ç y
        f,  // —Ñ–ª–∞–≥: –≤—ã—á–∏—Å–ª–∏—Ç—å out=x+y –µ—Å–ª–∏ (f == 1) –ò–õ–ò x&y –µ—Å–ª–∏ (f == 0)
        no; // —Ñ–ª–∞–≥: –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∞—É—Ç–ø—É—Ç out

    OUT
        out[16], // 16-–±–∏—Ç–Ω—ã–π –∞—É—Ç–ø—É—Ç: out;
        zr, // —Ñ–ª–∞–≥: zr=1 –µ—Å–ª–∏ (out == 0), –∏–Ω–∞—á–µ zr=0
        ng; // —Ñ–ª–∞–≥: ng=1 –µ—Å–ª–∏ (out < 0), –∏–Ω–∞—á–µ ng=0

    PARTS:
        // —à–∞–≥ 1. –µ—Å–ª–∏ (zx == 1) -> –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –∏–Ω–ø—É—Ç x –≤ 000‚Ä¶000
        // —à–∞–≥ 2. –µ—Å–ª–∏ (nx == 1) -> –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–ø—É—Ç x

        // —à–∞–≥ 3. –µ—Å–ª–∏ (zy == 1) -> –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –∏–Ω–ø—É—Ç y –≤ 000‚Ä¶000
        // —à–∞–≥ 4. –µ—Å–ª–∏ (ny == 1) -> –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–ø—É—Ç y

        // —à–∞–≥ 5. –≤—ã—á–∏—Å–ª—è–µ–º x+y –∏ x&y –æ—Ç–¥–µ–ª—å–Ω–æ
        // —à–∞–≥ 6. –µ—Å–ª–∏ (f == 1) -> out=x+y –ò–õ–ò x&y

        // —à–∞–≥ 7. –µ—Å–ª–∏ (no == 1) -> –∏–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∞—É—Ç–ø—É—Ç out
        // —à–∞–≥ 8. –µ—Å–ª–∏ (out < 0) -> —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—É—Ç–ø—É—Ç-—Ñ–ª–∞–≥ ng=1

        // —à–∞–≥ 9. –µ—Å–ª–∏ (out == 0) -> —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—É—Ç–ø—É—Ç-—Ñ–ª–∞–≥ zr=1
}

/*
    üåû –ü–æ–¥—Å–∫–∞–∑–∫–∞ üåû

    –ß—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –∏–Ω–ø—É—Ç –µ–¥–∏–Ω–∏—Ü—É ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ true.
    –ß—Ç–æ–±—ã –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–æ–ª—å ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ false.

    –ü—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–¥–∞–µ–º lsb=1:
    Not16(in[0]=true, out=output);

    –í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ –º—ã –ø–µ—Ä–µ–¥–∞–ª–∏ –µ–¥–∏–Ω–∏—Ü—É –≤ lsb,
    –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±–∏—Ç—ã in[1..15] —Å–∏–º—É–ª—è—Ç–æ—Ä –∑–∞–ø–æ–ª–Ω–∏–ª –Ω—É–ª—è–º–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

    –ú—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–æ–ª—å –≤ lsb –∏ –µ–¥–∏–Ω–∏—Ü—É –≤ msb:
    Not16(in[0]=false, in[15]=true, out=output);

    –ú–æ–∂–µ–º –∑–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –±–∏—Ç—ã –µ–¥–∏–Ω–∏—Ü–∞–º–∏:
    Not16(in=true, out=output);

    lsb ‚Äî —ç—Ç–æ least significant bit (–Ω–∞–∏–º–µ–Ω–µ–µ –∑–Ω–∞—á–∏–º—ã–π –±–∏—Ç, —Å–∞–º—ã–π –ø—Ä–∞–≤—ã–π).
    msb ‚Äî —ç—Ç–æ most significant bit (–Ω–∞–∏–±–æ–ª–µ–µ –∑–Ω–∞—á–∏–º—ã–π –±–∏—Ç, —Å–∞–º—ã–π –ª–µ–≤—ã–π).

    x001010y ‚Äî –∑–¥–µ—Å—å x —ç—Ç–æ msb, –∞ y —ç—Ç–æ lsb.

    ---

    üåû –ï—â–µ –ø–æ–¥—Å–∫–∞–∑–∫–∞ üåû

    –ß—Ç–æ–±—ã —Ä–∞–∑–¥–≤–æ–∏—Ç—å –∞—É—Ç–ø—É—Ç, –¥–æ–±–∞–≤—å—Ç–µ –≤ —á–∏–ø –µ—â–µ –æ–¥–∏–Ω out –ø–∏–Ω:
    DFF(in=input, out=–ø–µ—Ä–≤—ã–π_–∞—É—Ç–ø—É—Ç, out=–≤—Ç–æ—Ä–æ–π_–∞—É—Ç–ø—É—Ç);

    –ó–∞—Ç–µ–º –ø–µ—Ä–≤—ã–π –∞—É—Ç–ø—É—Ç –º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ –≤ out,
    –∞ –≤—Ç–æ—Ä–æ–π –∞—É—Ç–ø—É—Ç –≤—Å—Ç–∞–≤–∏—Ç—å –≤ –º—É–ª—å—Ç–∏–ø–ª–µ–∫—Å–æ—Ä.
*/

/*
    –ß–∏—Ç–∞–π—Ç–µ –≥–ª–∞–≤—É —É—á–µ–±–Ω–∏–∫–∞ –ø—Ä–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—É—é –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫—É:
    https://www.sukharev.io/app/courses/cs-part-1/arithmetic/intro

    https://www.sukharev.io/app/courses/cs-part-1/microarchitecture/computer 
    –∏–ª–∏ –ø–∏—à–∏—Ç–µ –Ω–∞ –ø–æ—á—Ç—É: help@sukharev.io
*/