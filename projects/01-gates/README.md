# Бекграунд

- Что такое логический гейт -> ссылка
- Булева алгебра -> ссылка
- Бинарные числа -> ссылка
- [Настройка окружения](README.md)

## HDL (язык описания железа компьютера)

В начале 70-х компьютеры паяли руками. Чтобы реализовать чип, инженер переводил его из таблицы истинности в логические выражения, которые потом упрощал и использовал как чертеж электросхемы.

В XXI веке компьютерные системы проектируют в симуляторах железа, которые все делают автоматически. Инженер, в программе, проектирует чип на языке HDL, а потом HDL-схема используется для массовой печати чипов роботами на заводе.

Чтобы использовать современные средства проектирования чипов — нужно владеть языком описания железа HDL.

В этом проекте мы соберем элементарные составные гейты и простейшие чипы в симуляторе железа, используя HDL.

## Синтаксис HDL

HDL (hardware description language) — это язык описания аппаратного обеспечения (железа). HDL существует в контексте программы-симулятора железа. Проектировать чип в симуляторе железа проще, чем перепаивать его вживую. Цена ошибки меньше, процесс разработки быстрее.

Любой язык программирования состоит из токенов, в том числе HDL. Токены — это ключевые слова и знаки, которые используются в языке. По-простому, токены в языке — это как слова и знаки препинания в тексте.

Компьютер понимает только строго определенный порядок токенов. Синтаксис языка определяет в какой последовательности могут стоять токены, чтобы соответствовать правилам грамматики языка. Токены не могут стоять в любой последовательности, также как слова в этом тексте.

Например, в языке HDL используются четыре ключевых слова: `CHIP`, `IN`, `OUT`, `PARTS`. И двенадцать знаков: `{ . ( : / [ } ] * = ) ,`. Всего шестнадцать токенов.

Ключевые слова и знаки образуют синтаксическую конструкцию описания электросхемы, ее HDL код ниже.

```java
CHIP chip_name { // название схемы
    IN a, b, c; // инпуты, которые принимает схема
    OUT x, y, z; // аутпуты, которые возвращает схема

    PARTS:
        // … реализация логической схемы (скрыта) …
}
```

Зеленым цветом выделены комментарии, они не являются частью схемы.

Эта конструкция используется во всех схемах (гейтах и чипах). Кроме нее в данной разновидности HDL ничего нет, поэтому выучить язык можно за полчаса практики.

Ключевое слово CHIP означает начало реализации чипа. За ключевым словом идет название чипа. В данном случае чип называется Not, это элементарный гейт. Ключевое слово CHIP не означает, что это обязательно чип, оно означает начало реализации электросхемы. Авторы языка решили не вводить ключевое слово GATE, чтобы не усложнять синтаксис языка. И гейты и чипы в этой разновидности языков HDL начинаются со слова CHIP.

Ключевое слово IN означает список инпутов, которые принимает схема. Ключевое слово OUT означает список аутпутов, которые схема возвращает.

Знаки `, { ; : }` являются разделителями. Например фигурные скобки обозначают { начало и конец } реализации чипа. Через запятую перечисляются инпуты (a, b, c, …) и аутпуты (x, y, z, …). Точка с запятой означает конец объявления инпутов и аутпутов.

Инпуты и аутпуты — это интерфейс чипа. Ключевое слово PARTS и знак : (PARTS:) означают начало реализации.

Давайте рассмотрим описания разных гейтов на HDL.

Начнем с гейта NOT.

```java
CHIP Not { // называется Not
    IN in; // принимает один инпут: in;
    OUT out; // возвращает один аутпут: out;

    PARTS:
        // … реализация логической схемы NOT (пока скрыта) …
}
```

Рассмотрим еще один пример:

```java
CHIP And {
    IN a, b;
    OUT out;

    PARTS:
        // … реализация логической схемы (пока скрыта) …

}
```

Как называется гейт? Сколько инпутов принимает? Сколько должен вернуть аутпутов?

Ответы (не читайте сразу, подумайте): Чип называется And, получает два инпута `a`, `b` и возвращает один аутпут `out`.

Теперь, когда мы разобрались, что означают ключевые слова и знаки, давайте перейдем к реализации логических схем.

## Реализация логических схем на HDL

Для примера рассмотрим реализацию составного гейта NAND из гейтов AND и NOT.

```java
CHIP Nand {

    IN x, y; // получаем два инпута: x, y;
    OUT z; // должны вернуть один аутпут: z;

    PARTS:
    // в гейт And передаем оба входящих инпута: a=x, b=y;
    // out записываем в xANDy переменную (пин);
    And(a=x, b=y, out=xANDy);
    // далее передаем пин xANDy в инпут гейта Not: in=xANDy;
    // полученный out выводим в главный out: out=z;
    Not(in=xANDy, out=z);

}
```

Теперь посмотрим на составной гейт Nand еще раз без зеленых комментариев.

```java
CHIP Nand {
    IN x, y;
    OUT z;

    PARTS:
        And(a=x, b=y, out=xANDy);
        Not(in=xANDy, out=z);
}
```

Вы можете думать о знаках равно (=), как о сплетающихся проводах. В гейт Nand входит два провода-инпута (`x` и `y`) и выходит один провод-аутпут `z`. Провода-инпуты Nand сплетаются с проводами-инпутами гейта And (`a=x` и `b=y`), а провод-аутпут гейта And сплетается с проводом-инпутом гейта Not (`in=xANDy`). В итоге, провод-аутпут гейта Not сплетается с главным аутпутом `out=z`.

(иллюстрация-дополнительно: В производстве чипов используется процесс называемый фотолитография, позволяющий проектировать чипы в нано-масштабе. Поэтому в чипах не используются провода, скорее микроскопические нити, также проводящие ток.)

Аутпуты (провода), которые выходят из гейтов внутри реализации, называются пинами. В примере выше пином является `xANDy`, в него записывается аутпут гейта And (`out=xANDy`). Пины можно называть, как вам больше нравится, главное, чтобы вам было понятно.

Вообще, лучше сразу посмотрите на сравнение гейт-схемы с HDL-схемой на рисунке ниже. Думаю, так будет понятнее, как это все работает.

(иллюстрация-рисунок: соответствие пинов и проводов)

## Далее

Теперь, когда (я очень надеюсь) вы поняли, как проектировать чипы в HDL — [переходите к практике](https://github.com/di-sukharev/computer/blob/4c88d0da3622a1f4e608f6c53e81d7c04c441376/projects/01-gates/elementary/README.md).

Даже если не поняли, все равно переходите к практике, вы обязательно разберетесь в процессе. А если у вас есть вопросы — задавайте их в телеграм группе [t.me/sukharev_qa](https://www.t.me/sukharev_qa) 🌞

## Подробнее

Производство чипов — Фотолитография: ссылка
